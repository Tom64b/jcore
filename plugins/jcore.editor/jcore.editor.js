//jCore library. www.jco.re/#license
;$$.editor=function(e){if(typeof e=='string'){if(e=='remove'){this.each(function(){var e=this.parentNode.parentNode;this.value=$(e).find('.jCoreEditorArea').html();e.parentNode.insertBefore(this,e);$(e).remove()})};if(e=='html'){var t=this[0].parentNode.parentNode;return $(t).find('.jCoreEditorArea').html()};return 1};e=e!==$.U?e:{};e.buttons=e.buttons!==$.U?e.buttons:'new,open,save,|,bold,italic,strikethrough,underline,|,subscript,superscript,|,font,color,size,|,justifyleft,justifycenter,justifyright,justifyfull,|,outdent,indent,removeformat,|,undo,redo,|,insertunorderedlist,insertorderedlist,inserthorizontalrule,|,createlink,unlink,image,|,cut,copy,paste,pasteplain,|,print,html';e.buttons=e.buttons.split(',');var n='new,open,save,bold,italic,strikethrough,underline,subscript,superscript,font,color,size,justifyleft,justifycenter,justifyright,justifyfull,outdent,indent,removeformat,undo,redo,insertunorderedlist,insertorderedlist,inserthorizontalrule,createlink,unlink,image,cut,copy,paste,pasteplain,print,html'.split(','),r='New,Open,Save,Bold,Italic,Strikethrough,Underline,Subscript,Superscript,Font,Text color,Text size,Justify left,Justify center,Justify right,Justify full,Outdent,Indent,Remove formatting,Undo,Redo,Insert list,Insert ordered list,Insert horizontal rule,Create link,Remove link,Insert image,Cut,Copy,Paste,Paste plain,Print,Edit HTML'.split(',');this.each(function(){var i=this,a=document.createElement('div');a.className='jCoreEditor';var u=document.createElement('div');u.className='jCoreEditorBar';a.appendChild(u);var l=document.createElement('div');l.className='jCoreEditorWrap';a.appendChild(l);i.parentNode.insertBefore(a,i);l.appendChild(i);var y=document.createElement('div');y.className='jCoreEditorMsg';a.appendChild(y);var t=document.createElement('div');t.className='jCoreEditorArea';t.contentEditable=!0;t.innerHTML=i.value;l.appendChild(t);$(t).on('click',function(){$('.jCoreEditorPaste').hide()});var p=document.createElement('div');p.className='jCoreEditorPaste';var j=document.createElement('textarea'),b=document.createElement('button');b.innerHTML='OK';p.appendChild(j);p.appendChild(b);a.appendChild(p);$(i.form).on('submit',function(e){i.value=t.innerHTML});$(b).on('click',function(e){e.preventDefault();t.focus();document.execCommand('insertHTML','',this.previousSibling.value);$(this.parentNode).hide()});var d=document.createElement('select');d.className='jCoreEditorSize';var h='10,12,16,20,24,36'.split(',');for(var o in h){$(d).append('<option style="font-size:'+h[o]+'px">'+h[o]+'</option>')};a.appendChild(d);var c=document.createElement('select');c.className='jCoreEditorColor';var f='yellow,orange,red,green,blue,silver,gray,black'.split(',');for(var o in f){$(c).append('<option style="color:'+f[o]+';background-color:'+f[o]+'">'+f[o]+'</option>')};a.appendChild(c);$(c).on('change',function(){document.execCommand('forecolor','',this.value);$(this).hide()});$(d).on('change',function(){document.execCommand('bold',!1,null);var r=window.getSelection(),t=r.focusNode.parentNode,e=document.createElement('span');e.innerHTML=t.innerHTML;$(e).css('font-size',this.value+'px');t.parentNode.replaceChild(e,t);var n=document.createRange();n.setStartBefore(e);n.setEndAfter(e);r.addRange(n);$(this).hide()});var m=document.createElement('select');m.className='jCoreEditorFont';var v='Arial,Times New Roman,Tahoma,Verdana,Georgia,Courier New'.split(',');for(var o in v){$(m).append('<option style="font-family:'+v[o]+'">'+v[o]+'</option>')};a.appendChild(m);var E=0;for(var o in e.buttons){var C=e.buttons[o],s=n.indexOf(C);s=s<0?0:s;var E=-5+s*-36,g=r[s];$(u).append(C=='|'?'<button class="sep"></button>':'<button title="'+g+'" id="action_'+C+'" style="background-position:'+E+'px -5px"></button>')};$(m).on('change',function(){document.execCommand('fontname','',this.value);$(this).hide()});$(u).find('button').on('click',function(d){d.preventDefault();if($(this).hasClass('sep')===!0)return 1;var e,a,s,c,o,C,n,u;c=$(this.parentNode.parentNode);$w=c.find('.jCoreEditorArea');e=this.id.replace('action_','');s=0;a=null;u=$(i).attr('id');n=null;switch(e){case'print':var r=document.createElement('iframe');r.name='jCoreEditorFrame';r.style.display='none';document.body.appendChild(r);var p=r.contentWindow||r.contentDocument;p.document.open();p.document.write('<html><head><title>DIV Contents</title></head><body>'+t.innerHTML+'</body></html>');p.close();setTimeout(function(){window.frames['jCoreEditorFrame'].focus();window.frames['jCoreEditorFrame'].print();r.remove()},500);break;case'image':var f=window.prompt('Image URL');if(f===null)return 1;a='<img class="jCoreEditorImage" src="'+f+'">';e='inserthtml';break;case'html':var m=$(i);if(m.css('display')=='none'){i.value=t.innerHTML;m.show();$(t).hide()}else{t.innerHTML=i.value;m.hide();$(t).show()};break;case'new':s='';break;case'save':localStorage['jcoreEditor'+u]=$w.html();break;case'open':s=localStorage['jcoreEditor'+u];break;case'font':n='Font';break;case'size':n='Size';break;case'color':n='Color';break;case'pasteplain':n='Paste';break;case'createlink':var a=window.prompt('URL');if(a===null)return 1};if(n){var o=$(this).offset();c.find('.jCoreEditor'+n).css({top:(23+o.top)+'px',left:(o.left+5)+'px'}).show();return};if(s!==0)$w.html(s);t.focus();try{document.execCommand(e,'',a)}catch(v){var l='Error';if(e=='cut')l='Try Ctrl+X to cut';else if(e=='copy')l='Try Ctr+C to copy';else if(e=='paste')l='Try Ctr+V to paste';var o=$(this).offset(),h=c.find('.jCoreEditorMsg').text(l).css({top:(23+o.top)+'px',left:(o.left+5)+'px'}).show();setTimeout(function(){h.hide()},2000)}})})};